% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={p8106\_hw1\_yt2785},
  pdfauthor={Yijing Tao yt2785},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{p8106\_hw1\_yt2785}
\author{Yijing Tao yt2785}
\date{}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.4     v dplyr   1.0.7
## v tidyr   1.1.3     v stringr 1.4.0
## v readr   2.0.1     v forcats 0.5.1
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ISLR)}
\FunctionTok{library}\NormalTok{(glmnet)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 载入需要的程辑包：Matrix
\end{verbatim}

\begin{verbatim}
## 
## 载入程辑包：'Matrix'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:tidyr':
## 
##     expand, pack, unpack
\end{verbatim}

\begin{verbatim}
## Loaded glmnet 4.1-3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(caret)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 载入需要的程辑包：lattice
\end{verbatim}

\begin{verbatim}
## 
## 载入程辑包：'caret'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:purrr':
## 
##     lift
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(corrplot)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## corrplot 0.92 loaded
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(plotmo)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 载入需要的程辑包：Formula
\end{verbatim}

\begin{verbatim}
## 载入需要的程辑包：plotrix
\end{verbatim}

\begin{verbatim}
## 载入需要的程辑包：TeachingDemos
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(FNN) }\CommentTok{\# knn.reg()}
\FunctionTok{library}\NormalTok{(doBy) }\CommentTok{\# which.minn()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 载入程辑包：'doBy'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     order_by
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(pls)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 载入程辑包：'pls'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:corrplot':
## 
##     corrplot
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:caret':
## 
##     R2
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:stats':
## 
##     loadings
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{train\_df }\OtherTok{=} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./housing\_training.csv"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{data.frame}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{na.omit}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 1440 Columns: 26
\end{verbatim}

\begin{verbatim}
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (4): Overall_Qual, Kitchen_Qual, Fireplace_Qu, Exter_Qual
## dbl (22): Gr_Liv_Area, First_Flr_SF, Second_Flr_SF, Total_Bsmt_SF, Low_Qual_...
\end{verbatim}

\begin{verbatim}
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{train\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{model.matrix}\NormalTok{(Sale\_Price}\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., train\_df)[ ,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{] }

\NormalTok{test\_df }\OtherTok{=} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"./housing\_test.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 959 Columns: 26
\end{verbatim}

\begin{verbatim}
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr  (4): Overall_Qual, Kitchen_Qual, Fireplace_Qu, Exter_Qual
## dbl (22): Gr_Liv_Area, First_Flr_SF, Second_Flr_SF, Total_Bsmt_SF, Low_Qual_...
\end{verbatim}

\begin{verbatim}
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  \FunctionTok{data.frame}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{na.omit}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## data frame with 0 columns and 0 rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{test\_matrix }\OtherTok{\textless{}{-}} \FunctionTok{model.matrix}\NormalTok{(Sale\_Price}\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., test\_df)[ ,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{] }
  
\CommentTok{\# matrix of predictors (glmnet uses input matrix)}
\NormalTok{x }\OtherTok{\textless{}{-}}\NormalTok{ train\_matrix}
\CommentTok{\# vector of response}
\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ train\_df}\SpecialCharTok{$}\NormalTok{Sale\_Price}

\NormalTok{ctrl1 }\OtherTok{\textless{}{-}} \FunctionTok{trainControl}\NormalTok{(}\AttributeTok{method =} \StringTok{"cv"}\NormalTok{, }\AttributeTok{selectionFunction =} \StringTok{"oneSE"}\NormalTok{)}
\NormalTok{ctrl2 }\OtherTok{\textless{}{-}} \FunctionTok{trainControl}\NormalTok{(}\AttributeTok{method =} \StringTok{"repeatedcv"}\NormalTok{, }\AttributeTok{number =} \DecValTok{10}\NormalTok{, }\AttributeTok{repeats =} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{a-fit-a-linear-model-using-least-squares-on-the-training-data.-is-there-any-potential-disadvantage-of-this-model}{%
\subsection{a) Fit a linear model using least squares on the training
data. Is there any potential disadvantage of this
model?}\label{a-fit-a-linear-model-using-least-squares-on-the-training-data.-is-there-any-potential-disadvantage-of-this-model}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lm.fit }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Sale\_Price }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ train\_df)}
\FunctionTok{summary}\NormalTok{(lm.fit)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = Sale_Price ~ ., data = train_df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -89864 -12424    416  12143 140205 
## 
## Coefficients: (1 not defined because of singularities)
##                              Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                -4.985e+06  3.035e+06  -1.642  0.10076    
## Gr_Liv_Area                 2.458e+01  1.393e+01   1.765  0.07778 .  
## First_Flr_SF                4.252e+01  1.409e+01   3.017  0.00260 ** 
## Second_Flr_SF               4.177e+01  1.379e+01   3.029  0.00250 ** 
## Total_Bsmt_SF               3.519e+01  2.744e+00  12.827  < 2e-16 ***
## Low_Qual_Fin_SF                    NA         NA      NA       NA    
## Wood_Deck_SF                1.202e+01  4.861e+00   2.474  0.01350 *  
## Open_Porch_SF               1.618e+01  1.004e+01   1.611  0.10736    
## Bsmt_Unf_SF                -2.087e+01  1.723e+00 -12.116  < 2e-16 ***
## Mas_Vnr_Area                1.046e+01  4.229e+00   2.473  0.01353 *  
## Garage_Cars                 4.229e+03  1.893e+03   2.234  0.02563 *  
## Garage_Area                 7.769e+00  6.497e+00   1.196  0.23195    
## Year_Built                  3.251e+02  3.130e+01  10.388  < 2e-16 ***
## TotRms_AbvGrd              -3.838e+03  6.922e+02  -5.545 3.51e-08 ***
## Full_Bath                  -4.341e+03  1.655e+03  -2.622  0.00883 ** 
## Overall_QualAverage        -5.013e+03  1.735e+03  -2.890  0.00391 ** 
## Overall_QualBelow_Average  -1.280e+04  2.677e+03  -4.782 1.92e-06 ***
## Overall_QualExcellent       7.261e+04  5.381e+03  13.494  < 2e-16 ***
## Overall_QualFair           -1.115e+04  5.240e+03  -2.127  0.03356 *  
## Overall_QualGood            1.226e+04  1.950e+03   6.287 4.30e-10 ***
## Overall_QualVery_Excellent  1.304e+05  8.803e+03  14.810  < 2e-16 ***
## Overall_QualVery_Good       3.798e+04  2.741e+03  13.852  < 2e-16 ***
## Kitchen_QualFair           -2.663e+04  6.325e+03  -4.210 2.71e-05 ***
## Kitchen_QualGood           -1.879e+04  4.100e+03  -4.582 5.01e-06 ***
## Kitchen_QualTypical        -2.677e+04  4.281e+03  -6.252 5.37e-10 ***
## Fireplaces                  1.138e+04  2.257e+03   5.043 5.18e-07 ***
## Fireplace_QuFair           -7.207e+03  6.823e+03  -1.056  0.29106    
## Fireplace_QuGood            6.070e+02  5.833e+03   0.104  0.91713    
## Fireplace_QuNo_Fireplace    3.394e+03  6.298e+03   0.539  0.59002    
## Fireplace_QuPoor           -5.185e+03  7.399e+03  -0.701  0.48362    
## Fireplace_QuTypical        -6.398e+03  5.897e+03  -1.085  0.27814    
## Exter_QualFair             -3.854e+04  8.383e+03  -4.598 4.66e-06 ***
## Exter_QualGood             -1.994e+04  5.585e+03  -3.569  0.00037 ***
## Exter_QualTypical          -2.436e+04  5.874e+03  -4.147 3.57e-05 ***
## Lot_Frontage                1.024e+02  1.905e+01   5.376 8.90e-08 ***
## Lot_Area                    6.042e-01  7.864e-02   7.683 2.91e-14 ***
## Longitude                  -3.481e+04  2.537e+04  -1.372  0.17016    
## Latitude                    5.874e+04  3.483e+04   1.686  0.09193 .  
## Misc_Val                    9.171e-01  1.003e+00   0.914  0.36071    
## Year_Sold                  -6.455e+02  4.606e+02  -1.401  0.16132    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 22190 on 1401 degrees of freedom
## Multiple R-squared:  0.9116, Adjusted R-squared:  0.9092 
## F-statistic: 380.3 on 38 and 1401 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lm.pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lm.fit, }\AttributeTok{newdata =}\NormalTok{ test\_df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in predict.lm(lm.fit, newdata = test_df): prediction from a rank-
## deficient fit may be misleading
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# test error}
\NormalTok{test\_error\_lm }\OtherTok{=} \FunctionTok{mean}\NormalTok{((lm.pred }\SpecialCharTok{{-}}\NormalTok{ test\_df}\SpecialCharTok{$}\NormalTok{Sale\_Price)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{test\_error\_lm}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 447287652
\end{verbatim}

**The test error of the LS linear model is
\ensuremath{4.4728765\times 10^{8}}. ** \textbf{The potential
disadvantage of this model might be the correlation between different
predictors.Although the adjusted R square is high in this model, there
might be over fitting in this model. And the p-value of this model is
less than 0.05, which means this model is not reliable.}

\hypertarget{b-fit-a-lasso-model-on-the-training-data-and-report-the-test-error.-when-the-1se-rule-is-applied-how-many-predictors-are-included-in-the-model}{%
\subsection{b) Fit a lasso model on the training data and report the
test error. When the 1SE rule is applied, how many predictors are
included in the
model?}\label{b-fit-a-lasso-model-on-the-training-data-and-report-the-test-error.-when-the-1se-rule-is-applied-how-many-predictors-are-included-in-the-model}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# check the range of lambda}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{cv.lasso }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(x, y, }
                      \AttributeTok{alpha =} \DecValTok{1}\NormalTok{, }
                      \AttributeTok{lambda =} \FunctionTok{exp}\NormalTok{(}\FunctionTok{seq}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{3}\NormalTok{, }\AttributeTok{length =} \DecValTok{100}\NormalTok{)))}
\FunctionTok{plot}\NormalTok{(cv.lasso)}
\end{Highlighting}
\end{Shaded}

\includegraphics{p8106_HW1_yt2785_files/figure-latex/unnamed-chunk-4-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# fit the lasso model}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{lasso.fit.minse }\OtherTok{\textless{}{-}} \FunctionTok{train}\NormalTok{(x, y,}
                   \AttributeTok{method =} \StringTok{"glmnet"}\NormalTok{,}
                   \AttributeTok{tuneGrid =} \FunctionTok{expand.grid}\NormalTok{(}\AttributeTok{alpha =} \DecValTok{1}\NormalTok{, }
                                          \AttributeTok{lambda =} \FunctionTok{exp}\NormalTok{(}\FunctionTok{seq}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{3}\NormalTok{, }\AttributeTok{length=}\DecValTok{100}\NormalTok{))),}
                   \AttributeTok{trControl =}\NormalTok{ ctrl2)}
\NormalTok{lasso.fit.minse}\SpecialCharTok{$}\NormalTok{bestTune}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    alpha   lambda
## 23     1 61.01447
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(lasso.fit.minse, }\AttributeTok{xTrans =}\NormalTok{ log)}
\end{Highlighting}
\end{Shaded}

\includegraphics{p8106_HW1_yt2785_files/figure-latex/unnamed-chunk-4-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lasso.pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lasso.fit.minse, }\AttributeTok{newdata =}\NormalTok{ test\_matrix)}
\CommentTok{\# test error}
\NormalTok{test\_error\_lasso\_minse }\OtherTok{=} \FunctionTok{mean}\NormalTok{((lasso.pred }\SpecialCharTok{{-}}\NormalTok{ test\_df}\SpecialCharTok{$}\NormalTok{Sale\_Price)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{test\_error\_lasso\_minse}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 440396463
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# apply the 1SE rule}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{lasso.fit}\FloatTok{.1}\NormalTok{se }\OtherTok{\textless{}{-}} \FunctionTok{train}\NormalTok{(x, y,}
                   \AttributeTok{method =} \StringTok{"glmnet"}\NormalTok{,}
                   \AttributeTok{tuneGrid =} \FunctionTok{expand.grid}\NormalTok{(}\AttributeTok{alpha =} \DecValTok{1}\NormalTok{, }
                                          \AttributeTok{lambda =} \FunctionTok{exp}\NormalTok{(}\FunctionTok{seq}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{3}\NormalTok{, }\AttributeTok{length=}\DecValTok{100}\NormalTok{))),}
                   \AttributeTok{trControl =}\NormalTok{ ctrl1)}

\FunctionTok{summary}\NormalTok{(lasso.fit}\FloatTok{.1}\NormalTok{se)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##             Length Class      Mode     
## a0            79   -none-     numeric  
## beta        3081   dgCMatrix  S4       
## df            79   -none-     numeric  
## dim            2   -none-     numeric  
## lambda        79   -none-     numeric  
## dev.ratio     79   -none-     numeric  
## nulldev        1   -none-     numeric  
## npasses        1   -none-     numeric  
## jerr           1   -none-     numeric  
## offset         1   -none-     logical  
## call           5   -none-     call     
## nobs           1   -none-     numeric  
## lambdaOpt      1   -none-     numeric  
## xNames        39   -none-     character
## problemType    1   -none-     character
## tuneValue      2   data.frame list     
## obsLevels      1   -none-     logical  
## param          0   -none-     list
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{precictor\_num }\OtherTok{=} \FunctionTok{sum}\NormalTok{((}\FunctionTok{coef}\NormalTok{(lasso.fit}\FloatTok{.1}\NormalTok{se}\SpecialCharTok{$}\NormalTok{finalModel, lasso.fit}\FloatTok{.1}\NormalTok{se}\SpecialCharTok{$}\NormalTok{bestTune}\SpecialCharTok{$}\NormalTok{lambda)) }\SpecialCharTok{!=} \DecValTok{0}\NormalTok{)}
\NormalTok{precictor\_num}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 30
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{lasso.pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lasso.fit}\FloatTok{.1}\NormalTok{se, }\AttributeTok{newdata =}\NormalTok{ test\_matrix)}
\CommentTok{\# test error}
\NormalTok{test\_error\_lasso\_1se }\OtherTok{=} \FunctionTok{mean}\NormalTok{((lasso.pred }\SpecialCharTok{{-}}\NormalTok{ test\_df}\SpecialCharTok{$}\NormalTok{Sale\_Price)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{test\_error\_lasso\_1se}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 421684149
\end{verbatim}

\textbf{From the first plot we can decide that lambda should be set
between exp(8) to exp(3), 30 predictors are included in the model when
1SE rule is applied. The test error of the minse lasso model is
\ensuremath{4.4039646\times 10^{8}} and the The test error of the 1se
lasso model is \ensuremath{4.2168415\times 10^{8}}}

\hypertarget{c-fit-an-elastic-net-model-on-the-training-data.-report-the-selected-tuning-parameters-and-the-test-error.}{%
\subsection{c) Fit an elastic net model on the training data. Report the
selected tuning parameters and the test
error.}\label{c-fit-an-elastic-net-model-on-the-training-data.-report-the-selected-tuning-parameters-and-the-test-error.}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{enet.fit }\OtherTok{\textless{}{-}} \FunctionTok{train}\NormalTok{(x, y,}
                  \AttributeTok{method =} \StringTok{"glmnet"}\NormalTok{,}
                  \AttributeTok{tuneGrid =} \FunctionTok{expand.grid}\NormalTok{(}\AttributeTok{alpha =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\AttributeTok{length =} \DecValTok{20}\NormalTok{), }
                                         \AttributeTok{lambda =} \FunctionTok{exp}\NormalTok{(}\FunctionTok{seq}\NormalTok{(}\DecValTok{8}\NormalTok{, }\DecValTok{4}\NormalTok{, }\AttributeTok{length =} \DecValTok{60}\NormalTok{))),}
                  \AttributeTok{trControl =}\NormalTok{ ctrl2)}
\NormalTok{enet.alpha.best }\OtherTok{=}\NormalTok{ enet.fit}\SpecialCharTok{$}\NormalTok{bestTune}\SpecialCharTok{$}\NormalTok{alpha}
\NormalTok{enet.alpha.best}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.05263158
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{enet.lambda.best }\OtherTok{=}\NormalTok{ enet.fit}\SpecialCharTok{$}\NormalTok{bestTune}\SpecialCharTok{$}\NormalTok{lambda}
\NormalTok{enet.lambda.best}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 585.7431
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(enet.fit)}
\end{Highlighting}
\end{Shaded}

\includegraphics{p8106_HW1_yt2785_files/figure-latex/unnamed-chunk-5-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{enet.pred }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(enet.fit, }\AttributeTok{newdata =}\NormalTok{ test\_matrix)}
\CommentTok{\# test error}
\NormalTok{test\_error\_enet }\OtherTok{=} \FunctionTok{mean}\NormalTok{((enet.pred }\SpecialCharTok{{-}}\NormalTok{ test\_df}\SpecialCharTok{$}\NormalTok{Sale\_Price)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{test\_error\_enet}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 438429127
\end{verbatim}

\textbf{The selected best parameter is alpha = 0.0526316 and lambda =
585.7431342. The test error is \ensuremath{4.3842913\times 10^{8}}.}

\hypertarget{d-fit-a-partial-least-squares-model-on-the-training-data-and-report-the-test-error.-how-many-components-are-included-in-your-model}{%
\subsection{d) Fit a partial least squares model on the training data
and report the test error. How many components are included in your
model?}\label{d-fit-a-partial-least-squares-model-on-the-training-data-and-report-the-test-error.-how-many-components-are-included-in-your-model}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{pls.mod }\OtherTok{\textless{}{-}} \FunctionTok{plsr}\NormalTok{(Sale\_Price }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }
                \AttributeTok{data =}\NormalTok{ train\_df, }
                \AttributeTok{scale =} \ConstantTok{TRUE}\NormalTok{,  }
                \AttributeTok{validation =} \StringTok{"CV"}\NormalTok{)}

\FunctionTok{summary}\NormalTok{(pls.mod)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Data:    X dimension: 1440 39 
##  Y dimension: 1440 1
## Fit method: kernelpls
## Number of components considered: 39
## 
## VALIDATION: RMSEP
## Cross-validated using 10 random segments.
##        (Intercept)  1 comps  2 comps  3 comps  4 comps  5 comps  6 comps
## CV           73685    33523    28388    25616    24536    23917    23693
## adjCV        73685    33517    28325    25518    24434    23814    23601
##        7 comps  8 comps  9 comps  10 comps  11 comps  12 comps  13 comps
## CV       23499    23465    23502     23512     23508     23504     23507
## adjCV    23418    23386    23417     23424     23419     23415     23417
##        14 comps  15 comps  16 comps  17 comps  18 comps  19 comps  20 comps
## CV        23520     23519     23529     23530     23536     23532     23542
## adjCV     23429     23428     23437     23439     23444     23441     23449
##        21 comps  22 comps  23 comps  24 comps  25 comps  26 comps  27 comps
## CV        23549     23553     23549     23550     23551     23552     23553
## adjCV     23456     23459     23456     23457     23457     23459     23460
##        28 comps  29 comps  30 comps  31 comps  32 comps  33 comps  34 comps
## CV        23554     23554     23554     23554     23554     23554     23554
## adjCV     23461     23461     23461     23461     23461     23461     23461
##        35 comps  36 comps  37 comps  38 comps  39 comps
## CV        23554     23554     23554     23554     23860
## adjCV     23461     23461     23461     23461     23312
## 
## TRAINING: % variance explained
##             1 comps  2 comps  3 comps  4 comps  5 comps  6 comps  7 comps
## X             20.02    25.93    29.67    33.59    37.01    40.03    42.49
## Sale_Price    79.73    86.35    89.36    90.37    90.87    90.99    91.06
##             8 comps  9 comps  10 comps  11 comps  12 comps  13 comps  14 comps
## X             45.53    47.97     50.15     52.01     53.69     55.35     56.86
## Sale_Price    91.08    91.10     91.13     91.15     91.15     91.16     91.16
##             15 comps  16 comps  17 comps  18 comps  19 comps  20 comps
## X              58.64     60.01     62.18     63.87     65.26     67.10
## Sale_Price     91.16     91.16     91.16     91.16     91.16     91.16
##             21 comps  22 comps  23 comps  24 comps  25 comps  26 comps
## X              68.44     70.12     71.72     73.35     75.20     77.27
## Sale_Price     91.16     91.16     91.16     91.16     91.16     91.16
##             27 comps  28 comps  29 comps  30 comps  31 comps  32 comps
## X              78.97     80.10     81.83     83.55     84.39     86.34
## Sale_Price     91.16     91.16     91.16     91.16     91.16     91.16
##             33 comps  34 comps  35 comps  36 comps  37 comps  38 comps
## X              88.63     90.79     92.79     95.45     97.49    100.00
## Sale_Price     91.16     91.16     91.16     91.16     91.16     91.16
##             39 comps
## X             100.67
## Sale_Price     91.16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{validationplot}\NormalTok{(pls.mod, }\AttributeTok{val.type=}\StringTok{"MSEP"}\NormalTok{, }\AttributeTok{legendpos =} \StringTok{"topright"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{p8106_HW1_yt2785_files/figure-latex/unnamed-chunk-6-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{cv.mse }\OtherTok{\textless{}{-}} \FunctionTok{RMSEP}\NormalTok{(pls.mod)}
\NormalTok{ncomp.cv }\OtherTok{\textless{}{-}} \FunctionTok{which.min}\NormalTok{(cv.mse}\SpecialCharTok{$}\NormalTok{val[}\DecValTok{1}\NormalTok{,,])}\SpecialCharTok{{-}}\DecValTok{1}
\NormalTok{ncomp.cv}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 8 comps 
##       8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{predy2.pls }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(pls.mod, }\AttributeTok{newdata =}\NormalTok{ test\_df, }
                      \AttributeTok{ncomp =}\NormalTok{ ncomp.cv)}
\CommentTok{\# test MSE}
\NormalTok{test\_error\_pls }\OtherTok{=} \FunctionTok{mean}\NormalTok{((predy2.pls }\SpecialCharTok{{-}}\NormalTok{ test\_df}\SpecialCharTok{$}\NormalTok{Sale\_Price)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{test\_error\_pls}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 440217938
\end{verbatim}

\textbf{8 components are included in the model. The test error of this
model is \ensuremath{4.4021794\times 10^{8}}.}

\hypertarget{e-which-model-will-you-choose-for-predicting-the-response-why}{%
\subsection{e) Which model will you choose for predicting the response?
Why?}\label{e-which-model-will-you-choose-for-predicting-the-response-why}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mse }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(test\_error\_lasso\_minse, test\_error\_lasso\_1se, test\_error\_enet, test\_error\_pls)}
\NormalTok{name }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Lasso(minse)"}\NormalTok{, }\StringTok{"Lasso(1se)"}\NormalTok{, }\StringTok{"Elastic"}\NormalTok{, }\StringTok{"PLS"}\NormalTok{)}
\NormalTok{MSE\_df }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(name, mse)}
\FunctionTok{colnames}\NormalTok{(MSE\_df) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Model"}\NormalTok{, }\StringTok{"MSE"}\NormalTok{)}
\NormalTok{MSE\_df }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(MSE\_df)}
\NormalTok{MSE\_df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          Model              MSE
## 1 Lasso(minse) 440396462.693672
## 2   Lasso(1se)  421684148.75126
## 3      Elastic 438429126.893179
## 4          PLS 440217937.923444
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{which.min}\NormalTok{(MSE\_df}\SpecialCharTok{$}\NormalTok{MSE)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2
\end{verbatim}

\textbf{From question a) we can consider that the LS linear model is not
reliable, so I decided not to include it in the comparision. I will
choose the lasso model which applied 1SE since it's MSE is the smallest
among these models, which means it has the highest accuracy and
efficiency.}

\end{document}
